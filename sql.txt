from pyspark.sql import SparkSession

# Create a SparkSession
spark = SparkSession.builder.appName("ReadStagedData").getOrCreate()

# Get the path to your staged CSV file (replace with your actual path)
staged_file_path = "path/to/your/staged/data.csv"

# Read the CSV file using Spark SQL
df = spark.read.csv(staged_file_path)

# You can now perform your desired analysis on the DataFrame (df)

# Print the schema (optional)
df.printSchema()

# Show a few rows of data (optional)
df.show(5)

# Stop the SparkSession
spark.stop()
